!function(a,b){function r(a,b){return this.userOptions=B(a),this.name=a.name||a,this.parent=b,this}function t(a){return parseInt(a,10)-.5}function u(a){for(var b=a.length,c=0;b--;)c+=a[b];return c}function v(a,b,c,d,e){var h,g=a.length;for(e||(e=0),c.depth||(c.depth=0);g--;)h=a[g],d&&(h.parent=d),h.categories?v(h.categories,b,c,h,e+1):w(b,h,d);c.depth=f(c.depth,e)}function w(a,b,c){for(a.unshift(new r(b,c));c;)c.leaves++||(c.leaves=1),c=c.parent}function x(a,b){a.push("M",t(b[0]),t(b[1]),"L",t(b[2]),t(b[3]))}function z(a,b){return a.getPosition(a.axis.horiz,b,a.axis.tickmarkOffset)}function A(a,b,c){for(var e,d=a.length;d--;)e=a[d][b],e&&A(e,b,c),c(a[d])}function B(a){return JSON.parse(JSON.stringify(a))}var c=void 0,e=(Math.round,Math.min),f=Math.max,g=a.merge,h=a.pick,i=a.Axis.prototype,j=a.Tick.prototype,k=i.init,l=i.render,m=i.setCategories,n=j.getLabelSize,o=j.addLabel,p=j.destroy,q=j.render;r.prototype.toString=function(){for(var a=[],b=this;b;)a.push(b.name),b=b.parent;return a.join(", ")},i.init=function(a,b){k.call(this,a,b),"object"===typeof b&&b.categories&&this.setupGroups(b)},i.setupGroups=function(a){var b,c=[],d={};b=B(a.categories),v(b,c,d),this.categoriesTree=b,this.categories=c,this.isGrouped=0!==d.depth,this.labelsDepth=d.depth,this.labelsSizes=[],this.labelsGridPath=[],this.tickLength=a.tickLength||this.tickLength||null,this.directionFactor=[-1,1,1,-1][this.side],this.options.lineWidth=a.lineWidth||1},i.render=function(){if(this.isGrouped&&(this.labelsGridPath=[]),this.originalTickLength===c&&(this.originalTickLength=this.options.tickLength),this.options.tickLength=this.isGrouped?.001:this.originalTickLength,l.call(this),!this.isGrouped)return void(this.labelsGrid&&this.labelsGrid.attr({visibility:"hidden"}));var q,r,a=this,b=a.options,d=a.top,e=a.left,f=e+a.width,g=d+a.height,i=a.hasVisibleSeries||a.hasData,j=a.labelsDepth,k=a.labelsGrid,m=a.horiz,n=a.labelsGridPath,o=b.drawHorizontalBorders===!1?j+1:0,p=a.opposite?m?d:f:m?g:e;for(a.userTickLength&&(j-=1),k||(r=h(b.tickWidth,a.isXAxis?1:0),k=a.labelsGrid=a.chart.renderer.path().attr({strokeWidth:r,"stroke-width":r,stroke:b.tickColor}).add(a.axisGroup));o<=j;)p+=a.groupSize(o),q=m?[e,p,f,p]:[p,d,p,g],x(n,q),o++;k.attr({d:n,visibility:i?"visible":"hidden"}),a.labelGroup.attr({visibility:i?"visible":"hidden"}),A(a.categoriesTree,"categories",function(b){var c=b.tick;c&&(c.startAt+c.leaves-1<a.min||c.startAt>a.max?(c.label.hide(),c.destroyed=0):c.label.attr({visibility:i?"visible":"hidden"}))})},i.setCategories=function(a,b){this.categories&&this.cleanGroups(),this.setupGroups({categories:a}),this.categories=this.userOptions.categories=a,m.call(this,this.categories,b)},i.cleanGroups=function(){var b,a=this.ticks;for(b in a)a[b].parent&&delete a[b].parent;A(this.categoriesTree,"categories",function(a){var c,b=a.tick;if(b){b.label.destroy();for(c in b)delete b[c];delete a.tick}}),this.labelsGrid=null},i.groupSize=function(a,b){var d=this.labelsSizes,e=this.directionFactor,g=this.options.labels.groupedOptions?this.options.labels.groupedOptions[a-1]:!1,h=0;return g&&(h=-1==e?g.x?g.x:0:g.y?g.y:0),b!==c&&(d[a]=f(d[a]||0,b+10+Math.abs(h))),a===!0?u(d)*e:d[a]?d[a]*e:0},j.addLabel=function(){var a;o.call(this),this.axis.categories&&(a=this.axis.categories[this.pos])&&(a.name&&this.label&&this.label.attr("text",this.axis.labelFormatter.call({axis:this.axis,chart:this.axis.chart,isFirst:this.isFirst,isLast:this.isLast,value:a.name})),this.axis.isGrouped&&this.axis.options.labels.enabled&&this.addGroupedLabels(a))},j.addGroupedLabels=function(a){for(var m,b=this,c=this.axis,d=c.chart,e=c.options.labels,f=e.useHTML,h=e.style,i=e.groupedOptions,j={align:"center",rotation:e.rotation,x:0,y:0},k=c.horiz?"height":"width",l=0;b;){if(l>0&&!a.tick){this.value=a.name;var n=e.formatter?e.formatter.call(this,a):a.name,o=i&&i[l-1],p=o?g(j,i[l-1]):j,q=o&&i[l-1].style?g(h,i[l-1].style):h;m=d.renderer.text(n,0,0,f).attr(p).css(q).add(c.labelGroup),b.startAt=this.pos,b.childCount=a.categories.length,b.leaves=a.leaves,b.visible=this.childCount,b.label=m,b.labelOffsets={x:p.x,y:p.y},a.tick=b}c.groupSize(l,b.label.getBBox()[k]),a=a.parent,b=a?b.parent=a.tick||{}:null,l++}},j.render=function(a,c,d){function H(a,c){var e=0;return l?(e=b.inArray(c.name,c.parent.categories),e=e<0?0:e):e}q.call(this,a,c,d);var g=this.axis.categories[this.pos];if(this.axis.isGrouped&&g&&!(this.pos>this.axis.max)){var B,C,D,E,F,G,h=this,i=h,j=h.axis,k=h.pos,l=h.isFirst,m=j.max,n=j.min,o=j.horiz,r=(j.categories[k],j.labelsGridPath),s=j.groupSize(0),v=(j.tickLength||s,j.directionFactor,z(h,k)),w=o?v.y:v.x,y=j.chart.renderer.fontMetrics(j.options.labels.style.fontSize).b,A=1;for(l&&(B=o?[j.left,v.y,j.left,v.y+j.groupSize(!0)]:j.isXAxis?[v.x,j.top,v.x+j.groupSize(!0),j.top]:[v.x,j.top+j.len,v.x+j.groupSize(!0),j.top+j.len],x(r,B)),o&&j.left<v.x?x(r,[v.x,v.y,v.x,v.y+s]):!o&&j.top<v.y&&x(r,[v.x,v.y,v.x+s,v.y]),s=w+s;i=i.parent;){var I=H(i,g,h),J=i.labelOffsets.x,K=i.labelOffsets.y;D=z(h,f(i.startAt-1,n-1)),E=z(h,e(i.startAt+i.leaves-1-I,m)),G=i.label.getBBox(!0),C=j.groupSize(A),F=o?{x:(D.x+E.x)/2+J,y:s+C/2+y-G.height/2-4+K/2}:{x:s+C/2+J,y:(D.y+E.y-G.height)/2+y+K},isNaN(F.x)||isNaN(F.y)||(i.label.attr(F),r&&(o&&j.left<E.x?x(r,[E.x,s,E.x,s+C]):!o&&j.top<E.y&&x(r,[s,E.y,s+C,E.y]))),s+=C,A++}}},j.destroy=function(){for(var a=this;a=a.parent;)a.destroyed++||(a.destroyed=1);p.call(this)},j.getLabelSize=function(){return this.axis.isGrouped===!0?u(this.axis.labelsSizes):n.call(this)}}(Highcharts,HighchartsAdapter);